<style>
.crew-section {
    width: 100%;
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 20px;
    background: #303132;
	border: 1px solid #e5e7eb;
	border-radius: 14px;
}

.crew-section .crew-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 50px;
    text-align: center;
}

.crew-section .profile-item {
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
}

.crew-section .profile-image-wrapper {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    overflow: hidden;
    border: 3px solid #ddd;
    transition: all 0.3s ease;
    position: relative;
}

.crew-section .profile-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.crew-section .profile-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0);
    transition: all 0.3s ease;
}

.crew-section .profile-item:hover .profile-image-wrapper {
    border-color: #ff6b35;
    transform: scale(1.1);
}

.crew-section .profile-item:hover .profile-overlay {
    background: rgba(255, 107, 53, 0.2);
}

.crew-section .profile-item.active .profile-image-wrapper {
    border-color: #ff6b35;
    transform: scale(1.1);
}

.crew-section .profile-label {
    text-align: center;
    margin-top: 10px;
}

.crew-section .profile-nickname {
    font-weight: 600;
    font-size: 0.9rem;
}

.crew-section .description-container {
    position: relative;
    width: 100%;
    max-width: 480px;
    margin: 0 auto;
}

.crew-section .description-box {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 8px 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
    opacity: 1;          /* <- √Ñndere von 0 zu 1 */
    transform: translateY(0);  /* <- √Ñndere von -10px zu 0 */
    transition: all 0.3s ease;
    min-height: 30px;
    position: relative;
}

.crew-section .description-box.visible {
    opacity: 1;
    transform: translateY(0);
}

.crew-section .description-arrow {
    position: absolute;
    top: -6px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 6px solid transparent;
    border-right: 6px solid transparent;
    border-bottom: 6px solid #f8f9fa;
}

.crew-section .description-title {
    font-size: 0.95rem;
    font-weight: 700;
    margin-bottom: 6px;
    margin-top: 0;        /* <- F√ºge hinzu */
    padding: 0;           /* <- F√ºge hinzu */
}

.crew-section .description-nickname {
    color: #ff6b35;
    font-style: italic;
    margin-left: 6px;
    font-size: 0.9rem;
}

.crew-section .description-text {
    font-size: 0.75rem;
    line-height: 1.4;
    color: #555;
    margin: 0;            /* <- F√ºge hinzu */
    padding: 0;           /* <- F√ºge hinzu */
}

.crew-section .description-placeholder {
    text-align: center;
    color: #999;
    font-style: italic;
    font-size: 0.8rem;
    display: block;
    margin: 0;           /* <- F√ºge hinzu */
    padding: 0;          /* <- F√ºge hinzu */
}

.crew-section .profile-grid {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    justify-items: center;
}

.crew-section .profile-item-mobile {
    position: relative;
    cursor: pointer;
    transition: all 0.3s ease;
}

.crew-section .profile-item-mobile .profile-image-wrapper {
    width: 100px;
    height: 100px;
}

.crew-section .profile-item-mobile:active .profile-image-wrapper {
    transform: scale(0.95);
}

.crew-section .profile-label-mobile {
    text-align: center;
    margin-top: 8px;
    font-size: 0.85rem;
}

.mobile-sheet-crew {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    border-radius: 20px 20px 0 0;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);
    transform: translateY(100%);
    transition: transform 0.3s ease;
    z-index: 9999;
    max-height: 70vh;
    overflow-y: auto;
}

.mobile-sheet-crew.active {
    transform: translateY(0);
}

.mobile-sheet-content {
    padding: 20px;
}

.mobile-sheet-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 20px;
}

.mobile-sheet-profile {
    display: flex;
    align-items: center;
    gap: 15px;
    flex: 1;
}

.mobile-sheet-image {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid #ff6b35;
}

.mobile-sheet-title {
    font-size: 1.2rem;
    font-weight: 700;
    margin: 0;
}

.mobile-sheet-close {
    background: #f0f0f0;
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    flex-shrink: 0;
}

.mobile-sheet-body {
    font-size: 0.95rem;
    line-height: 1.6;
    color: #555;
}

.mobile-sheet-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 9998;
}

.mobile-sheet-crew.active + .mobile-sheet-backdrop {
    opacity: 1;
    pointer-events: all;
}

.crew-section .mobile-instruction {
    text-align: center;
    color: #999;
    font-style: italic;
    margin-top: 20px;
}

.crew-section .desktop-only {
    display: block;
}

.crew-section .mobile-only {
    display: none;
}
/* ============================================
   TOOLTIP FIX - Korrekte Positionierung & Dynamische Section
   ============================================ */

/* Crew Section - Dynamisch wachsend */
.crew-section {
    width: 100%;
    max-width: 1400px;
    margin: 0 auto;
    padding: 40px 20px;
    background: #303132;
    border: 1px solid #e5e7eb;
    border-radius: 14px;
    transition: padding-bottom 0.3s ease;
}

/* Container f√ºr Profile + Tooltip */
.crew-section .profile-gallery {
    position: relative;
    margin-bottom: 30px;
}

/* Container f√ºr beide Tooltips - ZWISCHEN den Reihen */
.crew-section .description-container {
    position: relative;
    width: 100%;
    margin: 0 auto;
    min-height: 80px;
    transition: min-height 0.3s ease;
}

/* Standard Tooltip (ohne Pfeil, zentriert) */
.crew-section .description-box {
    background: #f8f9fa;
    border-radius: 8px;
    padding: 12px 20px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
    opacity: 1;
    transform: translateY(0);
    transition: opacity 0.3s ease;
    min-height: 40px;
    position: relative;
    max-width: 600px;
    margin: 0 auto;
}

/* Pfeil verstecken im Standard-Zustand */
.crew-section .description-box .description-arrow {
    display: none;
}

/* Hover Tooltip - Direkt UNTER dem jeweiligen Profil */
.crew-section .hover-tooltip {
    position: absolute;
    background: #f8f9fa;
    border-radius: 10px;
    padding: 14px 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease, transform 0.3s ease, top 0.3s ease, left 0.3s ease;
    transform: translateY(-10px);
    z-index: 100;
    min-width: 400px;
    max-width: 600px;
    width: max-content;
}

/* Hover Tooltip sichtbar machen */
.crew-section .hover-tooltip.visible {
    opacity: 1;
    transform: translateY(0);
    pointer-events: all;
}

/* Pfeil f√ºr Hover Tooltip */
.crew-section .hover-tooltip .tooltip-arrow {
    position: absolute;
    top: -8px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 8px solid #f8f9fa;
}

/* Standard Tooltip ausblenden wenn Hover aktiv */
.crew-section .description-box.hidden {
    opacity: 0;
}

/* Styling f√ºr Tooltip Content */
.crew-section .hover-tooltip .tooltip-content {
    text-align: left;
}

.crew-section .hover-tooltip .tooltip-title {
    font-size: 1rem;
    font-weight: 700;
    margin-bottom: 8px;
    margin-top: 0;
    padding: 0;
    line-height: 1.3;
}

.crew-section .hover-tooltip .tooltip-nickname {
    color: #ff6b35;
    font-style: italic;
    margin-left: 6px;
    font-size: 0.95rem;
}

.crew-section .hover-tooltip .tooltip-text {
    font-size: 0.85rem;
    line-height: 1.5;
    color: #555;
    margin: 0;
    padding: 0;
}

/* ============================================
   DYNAMISCHE ABST√ÑNDE F√úR REIHEN
   ============================================ */

/* Profile Rows Container */
.crew-section .profile-rows-container {
    position: relative;
    min-height: 400px;
    transition: min-height 0.3s ease;
}

/* Erste Reihe */
.crew-section .profile-row:first-of-type {
    margin-bottom: 30px;
    transition: margin-bottom 0.3s ease;
}

/* Erste Reihe mit aktivem Tooltip: Mehr Platz */
.crew-section .profile-row:first-of-type.has-active-tooltip {
    margin-bottom: 180px;
}

/* Zweite Reihe */
.crew-section .profile-row:nth-of-type(2) {
    margin-bottom: 30px;
    transition: margin-top 0.3s ease;
}

/* Description Container Positionierung */
.crew-section .description-container {
    margin-top: 20px;
}
</style>

{% set members = [
    {
        'name': 'Tuan (Anh)',
        'nickname': 'Babuschi',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_tuan.jpg',
        'description': 'Das √§lteste Mitglied der Gruppe - und definitiv das mit dem meisten Durchhalteverm√∂gen ‚Äì vier Stunden Schlaf reichen ihm v√∂llig, der Rest der Zeit geh√∂rt Gaming-Challenges, Reisen oder beidem gleichzeitig, sofern WLAN vorhanden ist. Taucht irgendwo eine Challenge auf, mutiert er zum pausenlosen Strategen mit leerem Controller-Akku als einzigem nat√ºrlichen Feind. Seit Stunde eins und eigentlich immer dabei ‚Äì selbst Hochzeitstage gelten maximal als freundliche Empfehlung. Fragt man ihn ruhig, ob er n√§chsten Donnerstag kommt, bekommt man ein √ºberraschend lautes, charmant-grantiges: Des is jo die n√§chste depperte Frog zur√ºck. Er ist eben Anh.'
    },
    {
        'name': 'Khoa',
        'nickname': 'Ruz',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_khoa.jpg',
        'description': 'Wer ihn kennt, wei√ü wenn irgendwo Fleisch brutzelt, ist er nicht weit. Ob Steak, Kotelett oder Grillspiess. Vegetarismus betrachtet er eher als mutige Theorie, denn als Lebensstil. Abends wird die Grillzange gegen K-Dramas getauscht, die er mit Champions-League-Intensit√§t konsumiert. Politische Diskussionen f√ºhrt er online gern, lang und mit ordentlich Nachdruck. Als Verkaufsprofi √ºberzeugt er dich nach ein bis f√ºnf Bieren garantiert von Dingen, die du vorher nie wolltest. Gr√ºndungsmitglied, j√ºngerer Bruder von Babushi, ganzj√§hriger Mopedfahrer und stolzer Familienvater ‚Äì der Spitzname stimmt √ºbrigens wirklich.'
    },
    {
        'name': 'Hysen',
        'nickname': 'Edi',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_edi.jpg',
        'description': 'Bald 45, aber immer noch in besserer Form als so mancher Fitness-Influencer. Auf der Baustelle stemmt er nicht nur Beton, sondern gleich die halbe Mannschaft mit. Kr√§ftig wie ein B√§r, charmant wie Van Damme nach dem dritten Bier und hauptverantwortlich daf√ºr, dass nur kurz auf ein Bier ein Mythos bleibt. Verheiratet, zweifacher Vater und Trinkfest-Organisator wider Willen. Als Mastermind der Namensgebungen seit Tag 1 Qebaptorero und bekennender Liebhaber von Fleisch, Bier und Spritzer. Wenn er keine Antwort wei√ü, wei√ü sie vermutlich niemand ‚Äì au√üer Gott.'
    },
    {
        'name': 'David',
        'nickname': 'Bugjake',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_bugjake.jpg',
        'description': 'Ende 30, aber mit der Energie eines hyperaktiven Studenten auf Red Bull-Dauerinfusion, und der Organisationsfreude eines Eventmanagers auf Koffein. Jede noch so absurde Gruppenaktion ist bei ihm sofort fix geplant ‚Äì inklusive WhatsApp-Gruppe. Inoffizieller IT-Admin der Clique und hauptverantwortlich f√ºr diese Seite. Verheiratet, Vater einer Tochter und musikalisch klar im Metallica-Lager: Ride the Lightning ist keine Phase, sondern Philosophie. Trinkt Sommerspritzer mit Hingabe ‚Äì und wenn er an einem Donnerstag fehlt, stimmt etwas nicht.'
    },
    {
        'name': 'Gregor',
        'nickname': 'Gretsch, Gjenase',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_gretsch.jpg',
        'description': 'Anfang 40, schlank wie eh und je - nicht, weil er auf Di√§t w√§re, sondern weil seine Gene einfach beschlossen haben, Fettreserven kategorisch abzulehnen. Als Programmierer jongliert er m√ºhelos mit Codezeilen, w√§hrend andere schon an Excel scheitern. Popkulturell eine Macht: erkennt Bond-Filme am Vorspann, kennt jedes Lichtschwert und singt Elton John erstaunlich textsicher. Gl√ºcklich verheiratet und frischgebackener Vater mit neu gewonnener Superkraft aus Dauerl√§cheln und Windelroutine. Ein klassischer Biertrinker, zu dem kein Cordon Bleu fehlen darf. Gute Seele der Runde und bevorzugter Sitznachbar: Marian.'
    },
    {
        'name': 'Balli',
        'nickname': 'Bali, Gagja',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_balli.jpg',
        'description': 'Mitte 30, mit einer Herkunft so interessant wie seine Playlist - halb Steiermark, halb Angola, und ganz einfach ein Naturtalent in Sachen Charme und guter Laune. Verheiratet, zweifacher Familienheld und charmanter Mittelpunkt jeder Runde ‚Äì meist mit Bier in der Hand. Er besitzt die beeindruckende F√§higkeit, enorme Mengen Bier und s√º√üsaure Suppe ohne Reue zu konsumieren. Als inoffizieller Hangout-Reservierer wei√ü er immer, wo es am besten schmeckt, klingt und passt. Stellt sich hartn√§ckig als Bali vor, schl√§ft gelegentlich mitten am Tisch ein ‚Äì Ursache unbekannt, Forschung l√§uft.'
    },
    {
        'name': 'Michael',
        'nickname': 'Michi',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_michi.jpg',
        'description': 'Anfang 40, verheiratet, stolzer Vater und wandelndes Lexikon f√ºr alles, was mit Marvel und Popkultur zu tun hat. Sobald ein Mikrofon auftaucht, wird er zum Karaoke-Held mit perfektem Shirt-Matching. Genussmensch durch und durch ‚Äì selbst experimentelle Bierkreationen w√ºrden Begeisterung ausl√∂sen. In der Gruppe das Genie f√ºr Photoshop und KI-Bilder, was die WhatsApp-Chats eindrucksvoll belegen. Kennt jedes importierte Bier und ist bei Karaokeabenden stets einsatzbereit.'
    },
    {
        'name': 'Christoph',
        'nickname': 'Stoffl, Bugjakinho',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_christoph.jpg',
        'description': 'Mitte 30, verheiratet, zweifacher Familienmanager und frisch im Raum Salzburg sesshaft geworden - angeblich, weil es da die perfekte Kombination aus Bergluft und Shisha-Bar gibt. Als Physiotherapeut bringt er andere in Bewegung, privat bleibt er selbst meist am Ball, denn Fu√üball ist Pflichtprogramm. Sein nat√ºrlicher Lebensraum liegt zwischen Shisha-Wolken, Spielanalysen und Familienaction. Die j√ºngere Version von Bugjake, falls der Name nicht gereicht hat. Trotz Entfernung immer wieder gern gesehen ‚Äì Lieblingsgetr√§nk: Shisha.'
    },
    {
        'name': 'Daniel',
        'nickname': 'Marian',
        'image': '/grav-admin/user/pages/01.home/_crew/profil_marian.jpg',
        'description': 'Anfang 30 und das letzte unverheiratete Einhorn der Gruppe - ein echter Starinfluencer, aktuell auf Bildungskarenz-Mission, um vermutlich die Welt (oder zumindest den Algorithmus) besser zu machen. Diskutiert mit einer Ausdauer, bei der selbst Khoa gelegentlich kapituliert. In der K√ºche herrscht bei ihm absolute Rezepttreue ‚Äì Abweichungen gelten als kulinarischer Extremismus. Sein Format Ryan The Mage erfreut sich gro√üer Beliebtheit im deutschsprachigen Raum. Wenn er an einem Donnerstag fehlt, dann nur wegen Novarock ‚Äì oder einer Debatte ohne Zeitlimit.'
    }
] %}

<section class="crew-section">
    <div class="crew-container">
        <div class="crew-header">
            <h2 class="crew-title">üßë‚Äçü§ù‚Äçüßë Die Crew</h2>
        </div>

        <div class="crew-main">
            <div class="profile-gallery">
<!-- Erste Reihe: 5 Mitglieder -->
<div class="profile-row desktop-only" style="display: flex; justify-content: center; gap: 20px; flex-wrap: nowrap; margin-bottom: 30px;">
    {% for member in members|slice(0, 5) %}
    <div class="profile-item" 
         data-id="{{ loop.index }}"
         data-name="{{ member.name }}"
         data-nickname="{{ member.nickname }}"
         data-description="{{ member.description }}">
        <div class="profile-image-wrapper">
            <img src="{{ member.image }}" 
                 alt="{{ member.name }} &quot;{{ member.nickname }}&quot;"
                 class="profile-image"
                 loading="lazy">
            <div class="profile-overlay"></div>
        </div>
        <div class="profile-label">
            <span class="profile-nickname">{{ member.nickname }}</span>
        </div>
    </div>
    {% endfor %}
</div>

<!-- Zweite Reihe: 4 Mitglieder -->
<div class="profile-row desktop-only" style="display: flex; justify-content: center; gap: 20px; flex-wrap: nowrap; margin-bottom: 30px;">
    {% for member in members|slice(5, 4) %}
    <div class="profile-item" 
         data-id="{{ loop.index + 5 }}"
         data-name="{{ member.name }}"
         data-nickname="{{ member.nickname }}"
         data-description="{{ member.description }}">
        <div class="profile-image-wrapper">
            <img src="{{ member.image }}" 
                 alt="{{ member.name }} &quot;{{ member.nickname }}&quot;"
                 class="profile-image"
                 loading="lazy">
            <div class="profile-overlay"></div>
        </div>
        <div class="profile-label">
            <span class="profile-nickname">{{ member.nickname }}</span>
        </div>
    </div>
    {% endfor %}
</div>

                <div class="profile-grid mobile-only">
                    {% for member in members %}
                    <div class="profile-item-mobile" 
                         data-id="{{ loop.index }}"
                         data-name="{{ member.name }}"
                         data-nickname="{{ member.nickname }}"
                         data-description="{{ member.description }}">
                        <div class="profile-image-wrapper">
                            <img src="{{ member.image }}" 
                                 alt="{{ member.name }} &quot;{{ member.nickname }}&quot;"
                                 class="profile-image"
                                 loading="lazy">
                            <div class="profile-overlay"></div>
                        </div>
                        <div class="profile-label-mobile">
                            <span class="profile-nickname">{{ member.nickname }}</span>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <div class="description-container desktop-only">
                    <div class="description-box">
                        <div class="description-arrow"></div>
                        <div class="description-content">
                            <p class="description-placeholder">
                                Fahre mit der Maus √ºber ein Profilbild, um mehr zu erfahren...
                            </p>
                        </div>
                    </div>
                </div>

                <div class="mobile-instruction mobile-only">
    <p style="text-align: center; color: #999; font-style: italic; font-size: 0.8rem; margin: 0; padding: 8px 0;">Tippe auf ein Profilbild, um mehr zu erfahren...</p>
                </div>
            </div>
        </div>
    </div>
</section>

<div id="mobile-sheet-crew" class="mobile-sheet-crew">
    <div class="mobile-sheet-content">
        <div class="mobile-sheet-header">
            <div class="mobile-sheet-profile">
                <img src="" alt="" class="mobile-sheet-image" id="sheet-image-crew">
                <h3 class="mobile-sheet-title" id="sheet-title-crew"></h3>
            </div>
            <button class="mobile-sheet-close" id="sheet-close-crew" aria-label="Schlie√üen">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
        <div class="mobile-sheet-body">
            <p id="sheet-description-crew"></p>
        </div>
    </div>
    <div class="mobile-sheet-backdrop" id="sheet-backdrop-crew"></div>
</div>

<script>
(function() {
    'use strict';
    
    let activeId = null;
    
function initDesktop() {
    const profileItems = document.querySelectorAll('.crew-section .profile-row .profile-item');
    const descriptionBox = document.querySelector('.crew-section .description-box');
    const descriptionContent = document.querySelector('.crew-section .description-content');
    const container = document.querySelector('.crew-section .description-container');
    const gallery = document.querySelector('.crew-section .profile-gallery');
    const firstRow = document.querySelector('.crew-section .profile-row:first-of-type');
    
    if (!profileItems.length || !descriptionBox || !container) return;
    
    // Hover Tooltip erstellen
    let hoverTooltip = document.querySelector('.crew-section .hover-tooltip');
    if (!hoverTooltip) {
        hoverTooltip = document.createElement('div');
        hoverTooltip.className = 'hover-tooltip';
        hoverTooltip.innerHTML = `
            <div class="tooltip-arrow"></div>
            <div class="tooltip-content"></div>
        `;
        gallery.appendChild(hoverTooltip);
    }
    
    const tooltipContent = hoverTooltip.querySelector('.tooltip-content');
    
    profileItems.forEach(function(item, index) {
        item.addEventListener('mouseenter', function() {
            const name = this.getAttribute('data-name');
            const nickname = this.getAttribute('data-nickname');
            const description = this.getAttribute('data-description');
            
            // Alle Items deaktivieren
            profileItems.forEach(function(p) {
                p.classList.remove('active');
            });
            this.classList.add('active');
            
            // Pr√ºfen ob in erster Reihe (erste 5 Items)
            const isFirstRow = index < 5;
            
            // Spacing f√ºr erste Reihe anpassen
            if (isFirstRow && firstRow) {
                firstRow.classList.add('has-active-tooltip');
            } else if (firstRow) {
                firstRow.classList.remove('has-active-tooltip');
            }
            
            // Position des Mitglieds ermitteln (relativ zur Gallery)
            const itemRect = this.getBoundingClientRect();
            const galleryRect = gallery.getBoundingClientRect();
            
            // Tooltip Content aktualisieren
            tooltipContent.innerHTML = 
                '<h3 class="tooltip-title">' + 
                name + 
                '<span class="tooltip-nickname">"' + nickname + '"</span>' +
                '</h3>' +
                '<p class="tooltip-text">' + description + '</p>';
            
            // WICHTIG: Position direkt unter dem Profilbild berechnen
            const profileLabel = this.querySelector('.profile-label');
            const labelHeight = profileLabel ? profileLabel.offsetHeight : 0;
            const itemBottom = itemRect.bottom - galleryRect.top;
            
            // Tooltip positionieren
            const left = itemRect.left - galleryRect.left + (itemRect.width / 2);
            const top = itemBottom + 10; // 10px Abstand unter dem Namen
            
            hoverTooltip.style.left = left + 'px';
            hoverTooltip.style.top = top + 'px';
            hoverTooltip.style.transform = 'translateX(-50%)';
            
            // Tooltips umschalten
            descriptionBox.classList.add('hidden');
            hoverTooltip.classList.add('visible');
            
            activeId = this.getAttribute('data-id');
        });
        
        item.addEventListener('mouseleave', function(event) {
            const relatedTarget = event.relatedTarget;
            
            // Nur ausblenden wenn nicht zum Tooltip gewechselt wird
            if (!relatedTarget || 
                (!relatedTarget.closest('.profile-item') && 
                 !relatedTarget.closest('.hover-tooltip'))) {
                clearTooltips();
            }
        });
    });
    
    // Hover Tooltip auch hover-f√§hig machen
    if (hoverTooltip) {
        hoverTooltip.addEventListener('mouseenter', function() {
            // Tooltip bleibt sichtbar
        });
        
        hoverTooltip.addEventListener('mouseleave', function(event) {
            const relatedTarget = event.relatedTarget;
            if (!relatedTarget || !relatedTarget.closest('.profile-item')) {
                clearTooltips();
            }
        });
    }
    
    function clearTooltips() {
        profileItems.forEach(function(item) {
            item.classList.remove('active');
        });
        
        // Spacing zur√ºcksetzen
        if (firstRow) {
            firstRow.classList.remove('has-active-tooltip');
        }
        
        descriptionBox.classList.remove('hidden');
        hoverTooltip.classList.remove('visible');
        activeId = null;
    }
}
    
    function initMobile() {
        const profileItems = document.querySelectorAll('.crew-section .profile-grid .profile-item-mobile');
        const mobileSheet = document.getElementById('mobile-sheet-crew');
        const sheetImage = document.getElementById('sheet-image-crew');
        const sheetTitle = document.getElementById('sheet-title-crew');
        const sheetDescription = document.getElementById('sheet-description-crew');
        const sheetClose = document.getElementById('sheet-close-crew');
        const sheetBackdrop = document.getElementById('sheet-backdrop-crew');
        
        if (!profileItems.length || !mobileSheet) return;
        
        profileItems.forEach(function(item) {
            item.addEventListener('click', function() {
                const id = this.getAttribute('data-id');
                const name = this.getAttribute('data-name');
                const nickname = this.getAttribute('data-nickname');
                const description = this.getAttribute('data-description');
                const imageSrc = this.querySelector('.profile-image').getAttribute('src');
                
                if (activeId === id) {
                    closeMobileSheet(profileItems, mobileSheet);
                    activeId = null;
                } else {
                    profileItems.forEach(function(p) {
                        p.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    openMobileSheet(mobileSheet, sheetImage, sheetTitle, sheetDescription, 
                                   imageSrc, name, nickname, description);
                    activeId = id;
                }
            });
        });
        
        if (sheetClose) {
            sheetClose.addEventListener('click', function() {
                closeMobileSheet(profileItems, mobileSheet);
                activeId = null;
            });
        }
        
        if (sheetBackdrop) {
            sheetBackdrop.addEventListener('click', function() {
                closeMobileSheet(profileItems, mobileSheet);
                activeId = null;
            });
        }
    }
    
    function openMobileSheet(sheet, image, title, description, imageSrc, name, nickname, desc) {
        image.setAttribute('src', imageSrc);
        image.setAttribute('alt', nickname);
        title.textContent = name + ' "' + nickname + '"';
        description.textContent = desc;
        
        sheet.classList.add('active');
        document.body.style.overflow = 'hidden';
    }
    
    function closeMobileSheet(items, sheet) {
        items.forEach(function(item) {
            item.classList.remove('active');
        });
        
        sheet.classList.remove('active');
        document.body.style.overflow = '';
    }
    
    // Init everything
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
            initDesktop();
            initMobile();
            updateVisibility();
            window.addEventListener('resize', updateVisibility);
        });
    } else {
        initDesktop();
        initMobile();
        updateVisibility();
        window.addEventListener('resize', updateVisibility);
    }
    
    // Visibility Fix
    window.updateVisibility = function() {
        const isMobile = window.innerWidth <= 768;
        
        // Profile rows/grids - ALLE Reihen behandeln
        const profileRows = document.querySelectorAll('.crew-section .profile-row');
        const profileGrid = document.querySelector('.crew-section .profile-grid');
        
        if (isMobile) {
            profileRows.forEach(function(row) {
                row.style.setProperty('display', 'none', 'important');
            });
            if (profileGrid) profileGrid.style.setProperty('display', 'grid', 'important');
        } else {
            profileRows.forEach(function(row) {
                row.style.setProperty('display', 'flex', 'important');
            });
            if (profileGrid) profileGrid.style.setProperty('display', 'none', 'important');
        }
        
        // Description container (desktop only)
        const descContainer = document.querySelector('.crew-section .description-container');
        if (descContainer) {
            descContainer.style.setProperty('display', isMobile ? 'none' : 'block', 'important');
        }
        
        // Mobile instruction (mobile only)  
        const mobileInstruction = document.querySelector('.crew-section .mobile-instruction');
        if (mobileInstruction) {
            mobileInstruction.style.setProperty('display', isMobile ? 'block' : 'none', 'important');
        }
    }
})();
</script>
